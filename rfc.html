<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Request for Change</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Request for Change</h1>
        <p>Request for change form for <a href="https://en.wikipedia.org/wiki/Change_management_(ITSM)">IT change management</a></p>

        <form>
            <!-- General Field Group -->
            <fieldset class="mb-4">
                <legend>General</legend>
                <div class="mb-3">
                    <label for="generalName" class="form-label">Name</label>
                    <input type="text" class="form-control" id="generalName" name="generalName">
                </div>
                <div class="mb-3">
                    <label for="generalDesc" class="form-label">Description</label>
                    <textarea class="form-control" id="generalDesc" name="generalDesc" rows="2"></textarea>
                </div>
            </fieldset>

            <!-- Classification Field Group -->
            <fieldset class="mb-4">
                <legend>Classification</legend>
                <div class="mb-3">
                    <label for="classificationType" class="form-label">Type</label>
                    <select class="form-select" id="classificationType" name="classificationType">
                        <option value="">Select type</option>
                        <option value="standard">Standard</option>
                        <option value="urgent">Urgent</option>
                        <option value="emergency">Emergency</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="classificationPriority" class="form-label">Priority</label>
                    <input type="number" class="form-control" id="classificationPriority" name="classificationPriority" min="1" max="5">
                </div>
            </fieldset>

            <!-- Risks Field Group -->
            <fieldset class="mb-4">
                <legend>Risks</legend>
                <div class="mb-3">
                    <label for="riskAssessment" class="form-label">Assessment</label>
                    <textarea class="form-control" id="riskAssessment" name="riskAssessment" rows="2"></textarea>
                </div>
                <div class="mb-3">
                    <label for="riskMitigation" class="form-label">Mitigation</label>
                    <textarea class="form-control" id="riskMitigation" name="riskMitigation" rows="2"></textarea>
                </div>
            </fieldset>

            <!-- Scheduling Field Group -->
            <fieldset class="mb-4">
                <legend>Scheduling</legend>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="scheduleStart" class="form-label">Start Date</label>
                        <input type="datetime-local" class="form-control" id="scheduleStart" name="scheduleStart">
                    </div>
                    <div class="col-md-6">
                        <label for="scheduleEnd" class="form-label">End Date</label>
                        <input type="datetime-local" class="form-control" id="scheduleEnd" name="scheduleEnd">
                    </div>
                </div>
            </fieldset>

            <button type="submit" class="btn btn-primary">Save</button>
        </form>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript">
        document.querySelector('form').addEventListener('submit', function(e) {
            e.preventDefault();

            // Clone the document
            const docClone = document.documentElement.cloneNode(true);

            // Update form fields in the clone with current values
            const origFields = document.querySelectorAll('input, textarea, select');
            const cloneFields = docClone.querySelectorAll('input, textarea, select');
            origFields.forEach((field, i) => {
                if (field.type === 'checkbox' || field.type === 'radio') {
                    cloneFields[i].checked = field.checked;
                } else if (field.tagName.toLowerCase() === 'textarea') {
                    cloneFields[i].setAttribute('textContent',field.value);
                } else {
                    cloneFields[i].setAttribute('value', field.value);
                }
            });

            // Serialize the clone to HTML
            const html = '<!DOCTYPE html>\n' + docClone.outerHTML;

            // Download as file
            const blob = new Blob([html], {type: 'text/html'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'rfc.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
        });
    </script>
</body>
</html>